# Dossier M3

## Inhaltsverzeichnis

1. [Ergebnisse](#uergebnisseu)
2. [Notizen](#unotizenu)

### <u>Ergebnisse</u>
- Aufgabe 1
    - Von beiden bearbeitet.
    - Location: <i>public/examples/M3/</i>
  - Aufgabe 2
      - Von beiden bearbeitet
      - <i>resources/views/articles/add.blade.php</i>
        - ```typescript
          /*
          TODO: Send post req. to webserver via AJAX (instead of submit's default behavior)
          DONE: 1. Event listener for the Submit button
          DONE: 2. Function sendData to submit via AJAX
          DONE: 3. Return response below form
          */
          document.getElementById('input_submit')!.addEventListener('click', event => {
          
              const formContent = {
                name: (document.querySelector('#input_name') as HTMLInputElement).value,
                description: (document.querySelector('#input_description') as HTMLInputElement).value,
                price: (document.querySelector('#input_price') as HTMLInputElement).value,
                category: (document.querySelector('#input_category') as HTMLInputElement).value,
                image: (document.querySelector('#input_image') as HTMLInputElement).value
              }

              event.preventDefault(); // Prevents default browser behavior when submitting forms
              submitButton.disabled = true; // Disable submit button until previous submission has been processed

              sendData(formContent);
          });
          function sendData(formContent)
          {
              let xhr = new XMLHttpRequest();
              xhr.open('POST', 'http://127.0.0.1:8000/articles/add');

              // Because TypeScript...
              const csrfElement = document.getElementById("csrf-token");
              if (csrfElement && csrfElement.getAttribute('content')) // if csrf-token exists (element & 'content' attribute)
              {
                  const csrfToken = csrfElement.getAttribute('content')!;
                  xhr.setRequestHeader("X-CSRF-TOKEN", csrfToken);
              }
              // Handle Webserver Response
              xhr.onreadystatechange = () => {
                  if (xhr.readyState === XMLHttpRequest.DONE) {
                      if (xhr.status === 200) {
                      // Display the success message returned from the server
                      messageContainer.textContent = "Erfolgreich";
                  }
                  else
                  {
                      // Display the error message returned from the server
                      messageContainer.textContent = "Fehler: " + xhr.responseText;
                  }
              }
          };

          // Send form data
          let formData = new FormData();
            
          for (let key in formContent)
          {
              formData.append('input_' + key, formContent[key]);
          }
          
          xhr.send(formData);
          
          // -- -- -- -- --
          // Error message
          const messageContainer = document.createElement('div');
          messageContainer.classList.add('alert', 'alert-info', 'text-center', 'col-span-2');


<hr>

### <u>Notizen</u>
- 

<hr>
